"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/extends"),t=require("react"),r=require("react-dom/client"),n=require("@react-three/fiber"),o=require("maath");function s(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function l(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var i=s(e),c=l(t),a=l(r);const f=c.createContext(null);function u(){return c.useContext(f)}const d=c.forwardRef((({children:e},t)=>{const r=c.useRef(null);c.useImperativeHandle(t,(()=>r.current),[]);const o=u(),{width:s,height:l}=n.useThree((e=>e.viewport));return n.useFrame((()=>{r.current.position.x=o.horizontal?-s*(o.pages-1)*o.offset:0,r.current.position.y=o.horizontal?0:l*(o.pages-1)*o.offset})),c.createElement("group",{ref:r},e)})),p=c.forwardRef((({children:e,style:t,...r},o)=>{const s=u(),l=c.useRef(null);c.useImperativeHandle(o,(()=>l.current),[]);const{width:d,height:p}=n.useThree((e=>e.size)),h=c.useContext(n.context),m=c.useMemo((()=>a.createRoot(s.fixed)),[s.fixed]);return n.useFrame((()=>{s.delta>s.eps&&(l.current.style.transform=`translate3d(${s.horizontal?-d*(s.pages-1)*s.offset:0}px,${s.horizontal?0:p*(s.pages-1)*-s.offset}px,0)`)})),m.render(c.createElement("div",i.default({ref:l,style:{...t,position:"absolute",top:0,left:0,willChange:"transform"}},r),c.createElement(f.Provider,{value:s},c.createElement(n.context.Provider,{value:h},e)))),null})),h=c.forwardRef((({html:e,...t},r)=>{const n=e?p:d;return c.createElement(n,i.default({ref:r},t))}));exports.Scroll=h,exports.ScrollControls=function({eps:e=1e-5,enabled:t=!0,infinite:r,horizontal:s,pages:l=1,distance:i=1,damping:a=.25,maxSpeed:u=1/0,style:d={},children:p}){const{get:h,setEvents:m,gl:v,size:g,invalidate:y,events:x}=n.useThree(),[w]=c.useState((()=>document.createElement("div"))),[E]=c.useState((()=>document.createElement("div"))),[b]=c.useState((()=>document.createElement("div"))),z=v.domElement.parentNode,C=c.useRef(0),L=c.useMemo((()=>{const t={el:w,eps:e,fill:E,fixed:b,horizontal:s,damping:a,offset:0,delta:0,scroll:C,pages:l,range(e,t,r=0){const n=e-r,o=n+t+2*r;return this.offset<n?0:this.offset>o?1:(this.offset-n)/(o-n)},curve(e,t,r=0){return Math.sin(this.range(e,t,r)*Math.PI)},visible(e,t,r=0){const n=e-r,o=n+t+2*r;return this.offset>=n&&this.offset<=o}};return t}),[e,a,s,l]);c.useEffect((()=>{w.style.position="absolute",w.style.width="100%",w.style.height="100%",w.style[s?"overflowX":"overflowY"]="auto",w.style[s?"overflowY":"overflowX"]="hidden",w.style.top="0px",w.style.left="0px";for(const e in d)w.style[e]=d[e];b.style.position="sticky",b.style.top="0px",b.style.left="0px",b.style.width="100%",b.style.height="100%",b.style.overflow="hidden",w.appendChild(b),E.style.height=s?"100%":l*i*100+"%",E.style.width=s?l*i*100+"%":"100%",E.style.pointerEvents="none",w.appendChild(E),z.appendChild(w),w[s?"scrollLeft":"scrollTop"]=1;const e=x.connected||v.domElement;requestAnimationFrame((()=>null==x.connect?void 0:x.connect(w)));const t=h().events.compute;return m({compute(e,t){const{left:r,top:n}=z.getBoundingClientRect(),o=e.clientX-r,s=e.clientY-n;t.pointer.set(o/t.size.width*2-1,-s/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),()=>{z.removeChild(w),m({compute:t}),null==x.connect||x.connect(e)}}),[l,i,s,w,E,b,z]),c.useEffect((()=>{if(x.connected===w){const e=g[s?"width":"height"],n=w[s?"scrollWidth":"scrollHeight"],o=n-e;let l=0,i=!0,c=!0;const a=()=>{if(t&&!c&&(y(),l=w[s?"scrollLeft":"scrollTop"],C.current=l/o,r)){if(!i)if(l>=o){const e=1-L.offset;w[s?"scrollLeft":"scrollTop"]=1,C.current=L.offset=-e,i=!0}else if(l<=0){const e=1+L.offset;w[s?"scrollLeft":"scrollTop"]=n,C.current=L.offset=e,i=!0}i&&setTimeout((()=>i=!1),40)}};w.addEventListener("scroll",a,{passive:!0}),requestAnimationFrame((()=>c=!1));const f=e=>w.scrollLeft+=e.deltaY/2;return s&&w.addEventListener("wheel",f,{passive:!0}),()=>{w.removeEventListener("scroll",a),s&&w.removeEventListener("wheel",f)}}}),[w,x,g,r,L,y,s,t]);let R=0;return n.useFrame(((t,r)=>{R=L.offset,o.easing.damp(L,"offset",C.current,a,r,u,void 0,e),o.easing.damp(L,"delta",Math.abs(R-L.offset),a,r,u,void 0,e),L.delta>e&&y()})),c.createElement(f.Provider,{value:L},p)},exports.useScroll=u;
