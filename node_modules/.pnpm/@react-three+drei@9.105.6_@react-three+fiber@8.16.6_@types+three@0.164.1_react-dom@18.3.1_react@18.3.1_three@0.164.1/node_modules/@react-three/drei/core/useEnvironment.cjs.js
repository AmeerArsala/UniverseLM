"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@react-three/fiber"),r=require("three"),n=require("three-stdlib"),t=require("@monogrid/gainmap-js"),s=require("../helpers/environment-assets.cjs.js"),i=require("../helpers/deprecated.cjs.js");const p=e=>Array.isArray(e);exports.useEnvironment=function({files:a=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"],path:o="",preset:l,encoding:d,extensions:g}={}){var u;let c,b=null,h=!1;if(l){if(!(l in s.presetsObj))throw new Error("Preset must be one of: "+Object.keys(s.presetsObj).join(", "));a=s.presetsObj[l],o="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/"}const j=p(a)&&6===a.length,f=p(a)&&3===a.length&&a.some((e=>e.endsWith("json"))),m=p(a)?a[0]:a;if(h=p(a),c=j?"cube":f?"webp":m.startsWith("data:application/exr")?"exr":m.startsWith("data:application/hdr")?"hdr":m.startsWith("data:image/jpeg")?"jpg":null==(u=m.split(".").pop())||null==(u=u.split("?"))||null==(u=u.shift())?void 0:u.toLowerCase(),b="cube"===c?r.CubeTextureLoader:"hdr"===c?n.RGBELoader:"exr"===c?n.EXRLoader:"jpg"===c||"jpeg"===c?t.HDRJPGLoader:"webp"===c?t.GainMapLoader:null,!b)throw new Error("useEnvironment: Unrecognized file extension: "+a);const x=e.useThree((e=>e.gl)),w=e.useLoader(b,h?[a]:a,(e=>{"webp"!==c&&"jpg"!==c&&"jpeg"!==c||e.setRenderer(x),null==e.setPath||e.setPath(o),g&&g(e)}));let v=h?w[0]:w;var E;return"jpg"!==c&&"jpeg"!==c&&"webp"!==c||(v=null==(E=v.renderTarget)?void 0:E.texture),v.mapping=j?r.CubeReflectionMapping:r.EquirectangularReflectionMapping,"colorSpace"in v?v.colorSpace=(null!=d?d:j)?"srgb":"srgb-linear":v.encoding=(null!=d?d:j)?i.sRGBEncoding:i.LinearEncoding,v};
